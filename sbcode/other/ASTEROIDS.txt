DEF p x,y,a,m,c:WHILE@0<m:s=u:t=v:v=c*(ASC(POP(m))-48)u=a+ASC(POP(m))GLINE x+c(s)*t,y+c(s-3)*t,x+c(u)*v,y+c(u-3)*v,-t:WEND:END:ACLS:XSCREEN 3SNDSTOP:BGMPLAY"@147V60Q4>>[CC+]"BGMSET #Y,@147v37o5b16_c:DIM t[8],u[8],v[8],g[8]h=240w=320FOR i=1TO 7p i*68,w,0,@03122332445263738392F3G203,i:NEXT:FOR I=0TO 11p 8,h+8,I,@0508,1NEXT:DISPLAY 1SPPAGE.FOR i=1TO 3n.,RND(h),6NEXT:x=w/2y=w@w:d=1CLS?p:VSYNC:GCLS:IF!k THEN i=BUTTON()r=r-(4AND i)/h+(8AND i)/h/2IF.>e&&i>>4THEN:p=p-1t[n]=40u[n]=x:v[n]=y:g[n]=a:e=11n=7AND n+1BGMPLAY 1,#Y ENDIF:a=a+r:r=r*.9i=1AND i:q=q*.99+c(a)*i/20o=o*.99+c(a-3)*i/20x=m(x+q,w)y=m(y+o,h)p x,y,a,@05567605,1:ENDIF:e=e-1CALL SPRITE:GOTO@w@u:c=CALLIDX:SPOFS c OUT f,j:SPCHR c OUT z,IF!k&&d(f-x,j-y,z/32+4)THEN k=1x x,y:BGMSTOP:ENDIF:FOR i=0TO 7IF t[i]THEN l=u[i]b=v[i]IF d THEN DEC t[i]s=g[i]p l,b,s,@0262,1u[i]=m(l+c(s)*5,w)v[i]=m(b+c(s-3)*5,h)ENDIF:IF d(f-l,j-b,z/32+4)THEN t[i]=0z=z/64-1x f,j:p=p+9SPCLR c:IF z THEN:n f,j,z:n f,j,z:ENDIF:RETURN'Me
NEXT:d=0SPOFS c,m(f+SPVAR(c,1),w),m(j+SPVAR(c,2),h)RETURN:DEF n x,y,s:_=SPSET(64*s,w-s*4,s*8,s*8,RND(16)*2+1)SPHOME _,4*s,s*4SPOFS _,x,y:SPVAR _,1,RNDF()*2-1SPVAR _,2,RNDF()*2-1SPFUNC _,@u:END:DEF m(a,b)RETURN a-b*FLOOR(a/b)END:DEF d(x,y,z)RETURN x*x+y*y<z*z:END:DEF c(a)RETURN COS(a/1.91)END:DEF x x,y:_=SPSET(#Y,255,3024)SPOFS _,X,Y+8BEEP 13,-4999SPANIM _,6,-30,.END

